import{r as p,C as le,J as ae,j as r,G as K,o as g,c as te,H as m,I as E,f as a,d as e,e as t,k as D,p as i,l as b,D as z,m as oe,B as ne,v as de}from"./index-C_8758mc.js";import{l as ue,g as re,u as se,a as ie,d as pe}from"./type-CW6g4tRd.js";const me={class:"app-container"},ce={class:"dialog-footer"},fe=ne({name:"Type"}),ve=Object.assign(fe,{setup(_e){const{proxy:c}=de(),R=p([]),f=p(!1),x=p(!0),w=p(!0),S=p([]),$=p(!0),q=p(!0),I=p(0),U=p(""),F=le({form:{},queryParams:{pageNum:1,pageSize:10,name:null,plateId:null,douser:null},rules:{name:[{required:!0,message:"类型名称不能为空",trigger:"blur"}],plateId:[{required:!0,message:"板块id不能为空",trigger:"blur"}],douser:[{required:!0,message:"执行人不能为空",trigger:"blur"}]}}),{queryParams:n,form:u,rules:Q}=ae(F);function y(){x.value=!0,ue(n.value).then(d=>{R.value=d.rows,I.value=d.total,x.value=!1})}function j(){f.value=!1,T()}function T(){u.value={id:null,name:null,plateId:null,douser:null},c.resetForm("typeRef")}function V(){n.value.pageNum=1,y()}function L(){c.resetForm("queryRef"),V()}function A(d){S.value=d.map(l=>l.id),$.value=d.length!=1,q.value=!d.length}function G(){T(),f.value=!0,U.value="添加任务类型"}function N(d){T();const l=d.id||S.value;re(l).then(_=>{u.value=_.data,f.value=!0,U.value="修改任务类型"})}function H(){c.$refs.typeRef.validate(d=>{d&&(u.value.id!=null?se(u.value).then(l=>{c.$modal.msgSuccess("修改成功"),f.value=!1,y()}):ie(u.value).then(l=>{c.$modal.msgSuccess("新增成功"),f.value=!1,y()}))})}function P(d){const l=d.id||S.value;c.$modal.confirm('是否确认删除任务类型编号为"'+l+'"的数据项？').then(function(){return pe(l)}).then(()=>{y(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function J(){c.download("task/type/export",{...n.value},`type_${new Date().getTime()}.xlsx`)}return y(),(d,l)=>{const _=r("el-input"),v=r("el-form-item"),s=r("el-button"),B=r("el-form"),C=r("el-col"),O=r("right-toolbar"),M=r("el-row"),h=r("el-table-column"),W=r("el-table"),X=r("pagination"),Y=r("el-dialog"),k=K("hasPermi"),Z=K("loading");return g(),te("div",me,[m(e(B,{model:a(n),ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[e(v,{label:"类型名称",prop:"name"},{default:t(()=>[e(_,{modelValue:a(n).name,"onUpdate:modelValue":l[0]||(l[0]=o=>a(n).name=o),placeholder:"请输入类型名称",clearable:"",onKeyup:D(V,["enter"])},null,8,["modelValue"])]),_:1}),e(v,{label:"板块id",prop:"plateId"},{default:t(()=>[e(_,{modelValue:a(n).plateId,"onUpdate:modelValue":l[1]||(l[1]=o=>a(n).plateId=o),placeholder:"请输入板块id",clearable:"",onKeyup:D(V,["enter"])},null,8,["modelValue"])]),_:1}),e(v,{label:"执行人",prop:"douser"},{default:t(()=>[e(_,{modelValue:a(n).douser,"onUpdate:modelValue":l[2]||(l[2]=o=>a(n).douser=o),placeholder:"请输入执行人",clearable:"",onKeyup:D(V,["enter"])},null,8,["modelValue"])]),_:1}),e(v,null,{default:t(()=>[e(s,{type:"primary",icon:"Search",onClick:V},{default:t(()=>[i("搜索")]),_:1}),e(s,{icon:"Refresh",onClick:L},{default:t(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[E,a(w)]]),e(M,{gutter:10,class:"mb8"},{default:t(()=>[e(C,{span:1.5},{default:t(()=>[m((g(),b(s,{type:"primary",plain:"",icon:"Plus",onClick:G},{default:t(()=>[i("新增")]),_:1})),[[k,["task:type:add"]]])]),_:1}),e(C,{span:1.5},{default:t(()=>[m((g(),b(s,{type:"success",plain:"",icon:"Edit",disabled:a($),onClick:N},{default:t(()=>[i("修改")]),_:1},8,["disabled"])),[[k,["task:type:edit"]]])]),_:1}),e(C,{span:1.5},{default:t(()=>[m((g(),b(s,{type:"danger",plain:"",icon:"Delete",disabled:a(q),onClick:P},{default:t(()=>[i("删除")]),_:1},8,["disabled"])),[[k,["task:type:remove"]]])]),_:1}),e(C,{span:1.5},{default:t(()=>[m((g(),b(s,{type:"warning",plain:"",icon:"Download",onClick:J},{default:t(()=>[i("导出")]),_:1})),[[k,["task:type:export"]]])]),_:1}),e(O,{showSearch:a(w),"onUpdate:showSearch":l[3]||(l[3]=o=>z(w)?w.value=o:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),m((g(),b(W,{data:a(R),onSelectionChange:A},{default:t(()=>[e(h,{type:"selection",width:"55",align:"center"}),e(h,{label:"Primary Key",align:"center",prop:"id"}),e(h,{label:"类型名称",align:"center",prop:"name"}),e(h,{label:"板块id",align:"center",prop:"plateId"}),e(h,{label:"执行人",align:"center",prop:"douser"}),e(h,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(o=>[m((g(),b(s,{link:"",type:"primary",icon:"Edit",onClick:ee=>N(o.row)},{default:t(()=>[i("修改")]),_:2},1032,["onClick"])),[[k,["task:type:edit"]]]),m((g(),b(s,{link:"",type:"primary",icon:"Delete",onClick:ee=>P(o.row)},{default:t(()=>[i("删除")]),_:2},1032,["onClick"])),[[k,["task:type:remove"]]])]),_:1})]),_:1},8,["data"])),[[Z,a(x)]]),m(e(X,{total:a(I),page:a(n).pageNum,"onUpdate:page":l[4]||(l[4]=o=>a(n).pageNum=o),limit:a(n).pageSize,"onUpdate:limit":l[5]||(l[5]=o=>a(n).pageSize=o),onPagination:y},null,8,["total","page","limit"]),[[E,a(I)>0]]),e(Y,{title:a(U),modelValue:a(f),"onUpdate:modelValue":l[9]||(l[9]=o=>z(f)?f.value=o:null),width:"500px","append-to-body":""},{footer:t(()=>[oe("div",ce,[e(s,{type:"primary",onClick:H},{default:t(()=>[i("确 定")]),_:1}),e(s,{onClick:j},{default:t(()=>[i("取 消")]),_:1})])]),default:t(()=>[e(B,{ref:"typeRef",model:a(u),rules:a(Q),"label-width":"80px"},{default:t(()=>[e(v,{label:"类型名称",prop:"name"},{default:t(()=>[e(_,{modelValue:a(u).name,"onUpdate:modelValue":l[6]||(l[6]=o=>a(u).name=o),placeholder:"请输入类型名称"},null,8,["modelValue"])]),_:1}),e(v,{label:"板块id",prop:"plateId"},{default:t(()=>[e(_,{modelValue:a(u).plateId,"onUpdate:modelValue":l[7]||(l[7]=o=>a(u).plateId=o),placeholder:"请输入板块id"},null,8,["modelValue"])]),_:1}),e(v,{label:"执行人",prop:"douser"},{default:t(()=>[e(_,{modelValue:a(u).douser,"onUpdate:modelValue":l[8]||(l[8]=o=>a(u).douser=o),placeholder:"请输入执行人"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{ve as default};
